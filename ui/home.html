<div class="ocultars">
	<h1>Bienvenido a la pagina inicial</h1>
	<p><a class="form_inicio_registro" id="iniciof" href="#"></a></p>
	<p><a class="form_inicio_registro" id="registrof" href="#">Registrarse</a></p>
</div>


<!-- <section class="bck-parallax alto">
		<div class="container">
			<h2>Aqui va una descripcion o alguna frase</h2>
		</div>
	</section> -->
		<section id="mapa1">
			<div id='info_evento_home' >
			<span id='cerrar_datos_reporte_home' style='display:none;'>Cerrar</span>
				<div id='datos_reporte_home' style='display:none;' ></div>
				<img src='/ui/images/loading.GIF' style='display:none;' />
			</div>
		</section>
			<div id='mapa'>

				<div id='search_home'>
					<input id='search_home_input' name='search' input type="text" x-webkit-speech />
					<input id='search_ciudadano' type="checkbox" name="ciudadano" value="c" checked>Ciudadano
					<input id='search_gobierno' type="checkbox" name="gobierno" value="g">Gobierno 
					<input id='search_home_send' type='button' value='Buscar' />
				</div>

				<div id="map" style="height:380px;"></div>


			</div>
	<section class="azul">
		<div class="container ">
			<div class="row espacio">
				<div class="col-md-12">
					<h1><span class="lai">Lorem Ipsum is simply dummy text</span> of the printing and typesetting industry.<span class="lai"> Lorem Ipsum has been the industry's standard</span></h1>

				</div>
					<div class="col-md-12 medio">
						<button type="button" class=" color-grande btn btn-default btn-lg" >Leer Más</buttom>
					</div>
			</div>

		</div>
	</section>
	<section class="bck-parallax usuarios">
		<div class="container">
			<div class="row">
				<div class="col-md-4 pt20"><a href="">
					<img src="ui/images/ninas.jpg" height="400" width="660" alt="" class="img-responsive">
					<div class="usuario1 tipografia color-fondo">
						<h3><span class="lai">Reportar como</span> CUIDADANO</h3>
					</div></a>
				</div>
				<div class="col-md-4 pt20"><a href="">
					<img src="ui/images/gobierno.jpg" height="400" width="660" alt="" class="img-responsive">
					<div class="usuario2 tipografia color-fondo">
						<h3><span class="lai">Reportar como</span> OFICIAL</h3>
					</div></a>
				</div>
				<div class="col-md-4 pt20">
					<img src="ui/images/edificio.jpg" height="400" width="660" alt="" class="img-responsive" style="opacity:0.8;">
					<div class="usuario3 tipografia color-dos">
						<h3><span class="lai">Reportar como</span> EMPRESA</h3>
					</div>
				</div>
			</div>
		</div>
	</section>
	<section>
		<div class="container">
			<div class="row caras-ocultas ">
				<div class="col-md-4 ">
					<img src="ui/images/roberto_silueta.png"  width="200" alt="" class="img-responsive silueta">
					<div class="medidas-info">
						<h3>Roberto Hernández</h3>
						<div class="information">
							<div class="sprite"></div><p>@wolkmx</p>
							<div class="sprite1"></div><p>robertohdll@gmail.com</p>

						</div>	
					</div>
				</div>
				<div class="col-md-4 ">
					<img src="ui/images/julia_silueta.png"  width="200" alt="" class="img-responsive silueta">
						<div class="medidas-info">
						<h3>Julia<br> Fernández</h3>
						<div class="information">
							<div class="sprite"></div><p>@jluisana7</p>
							<div class="sprite1"></div><p>julia.luisana@gmail.com</p>

						</div>	
					</div>
				</div>
				<div class="col-md-4 ">
					<img src="ui/images/oscar_silueta.png"  width="200" height="400" alt="" class="img-responsive silueta mb20">
						<div class="medidas-info">
						<h3>Oscar <br>Galindez</h3>
						<div class="information">
							<div class="sprite"></div><p>@oscarabreu19</p>
							<div class="sprite1"></div><p>oscarabreu19@gmail.com</p>

						</div>	
					</div>
				</div>
			</div>
		</div>
	</section>






<div id="content" style="left: 432px; position: absolute; top: 304.5px; z-index: 9999; opacity: 0; display: none;background-color: #fff; border-radius: 10px; box-shadow: 0 0 25px 5px #999;">
</div>
<script type="text/javascript">
//Se declaran globalmente los markers y el mapa para que pueda ser referenciado a lo largo de los scripts
var evento = [];
var map = null;
$(document).ready(function(){


 /*Codigo javascript para refrescar la seccion principal "content" para mostrar el formulario de registro/inicio de sesion */
	$(".form_inicio_registro").click(function(){
		 $.ajax({
			type: 'POST',
			url: '/login', 
			}).done(function(html){
				$( "#content" ).html( html );
				$('#content').bPopup();
				
			});
	});

//Se declara un arreglo vacio de elementos para guardar todos los markers
var eventosrecientes = [];

	<repeat group="{{ @eventosrecientes }}" key="{{ @k }}" value="{{ @evento }}">
	eventosrecientes[{{ @k }}]=[];
		<repeat group="{{ @evento }}" key = "{{ @key }}" value="{{ @atributo }}">
			 eventosrecientes[{{ @k }}]["{{ @key }}"] = "{{ @atributo }}";
		</repeat>
	</repeat>

//alert(eventosrecientes[0]["firtsName"]);
//alert(eventosrecientes["eventos"][0]["idEvento"]);


	//Se inicializa el mapa para mostrarlo en una posicion generica para que se vea latinoamerica
	
	var osmUrl = 'http://{s}.tile.osm.org/{z}/{x}/{y}.png',
							osmAttribution = '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
							osm = new L.TileLayer(osmUrl, {maxZoom: 18, attribution: osmAttribution});
				
	var mapLayer = new L.TileLayer(osmUrl);
	
	map = new L.Map('map').setView([ 14.216108846888353, -81.123046875], 5);;
	map.addLayer(mapLayer);
	
	//Se obtiene la posicion del usuario desde el navegador y se coloca el mapa en ese punto
	map.locate({setView : true, maxZoom : 15});
	
	//Se deben agregar los ultimos 10 eventos en markers 

	//alert(eventosrecientes[0]["lat"]);
	
	/*obtener latitud y longitud*/
	/*map.on('click', function(e) {
		alert("Lat, Lon : " + e.latlng.lat + ", " + e.latlng.lng);
	});*/
	
	
	//var evento = [];
	var index;

	for (index = 0; index < eventosrecientes.length; ++index) {
		//Icono
		var icono = L.icon({
			iconUrl: '/uploads/'+eventosrecientes[index]["imagePing"],

			iconSize:     [68, 61], // size of the icon
			iconAnchor:   [65, 58], // point of the icon which will correspond to marker's location
			popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
		});
		
		//Se crea una instancia del indice para que este dentro del contexto de la variable	
		var i = index;
		//Se crea un marker para indicar los eventos encontrados, se le agrega el titulo del tipo de evento y la enfermedad y se agrega un on clic para mostrar el div con la informacion del evento
		/*evento[index] = L.marker([eventosrecientes[index]["lat"], eventosrecientes[index]["lon"]],{ title: eventosrecientes[index]["categoriaName"]+': '+eventosrecientes[index]["name"] }).addTo(map).on('click', function(){ 
				$('#info_evento_home').html(eventosrecientes[i]["name"] );
			 } );*/

		/*evento[index] = L.marker([eventosrecientes[index]["lat"], eventosrecientes[index]["lon"]],{ title: eventosrecientes[index]["categoriaName"]+': '+eventosrecientes[index]["name"] }).addTo(map);*/
		
		evento[index] = L.marker([eventosrecientes[index]["lat"], eventosrecientes[index]["lon"]],{ title: eventosrecientes[index]["categoriaName"]+': '+eventosrecientes[index]["name"] , icon: icono}).addTo(map);
		
evento[index].indice = index;


	}

	for(var j = 0; j < eventosrecientes.length; j++){
	
	evento[j].on('click', function(){ 

		/* Datos originales
		"
		
			<ul>
			     	<li><span class='titulo_dato_home'>Tipo de reporte:<span> "+eventosrecientes[this.indice]['categoriaName']+"</li>
				<li><span class='titulo_dato_home'>Enfermedad:<span> "+eventosrecientes[this.indice]['name']+"</li>
				<li><span class='titulo_dato_home'>Usuario que Reporta:<span> "+eventosrecientes[this.indice]['alias']+"</li>
				<li><span class='titulo_dato_home'>Reportado el:<span> "+eventosrecientes[this.indice]['created_at']+"</li>
			</ul>
		"

		*/
		var contenido =  "<ul><li><span class='titulo_dato_home'>Tipo de reporte:<span> "+eventosrecientes[this.indice]['categoriaName']+"</li><li><span class='titulo_dato_home'>Enfermedad:<span> "+eventosrecientes[this.indice]['name']+"</li><li><span class='titulo_dato_home'>Usuario que Reporta:<span> "+eventosrecientes[this.indice]['alias']+"</li><li><span class='titulo_dato_home'>Reportado el:<span> "+eventosrecientes[this.indice]['created_at']+"</li></ul>";
			/*$('#info_evento_home img').fadeIn();*/
			$('#info_evento_home').css('height','0px');
			$('#info_evento_home').css('height','200px');
			$('#cerrar_datos_reporte_home').fadeIn('slow');
			
			$('#datos_reporte_home').fadeIn('slow');
			$('#datos_reporte_home').html(contenido);
			etiquetasConsejo(eventosrecientes[this.indice]["idEvento"]);

		 } );

	}


	
});

</script>



